<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VideoTube Kids</title>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Roboto', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: #f9f9f9; overflow-x: hidden; height: 100vh; width: 100vw; position: relative; }
        
        #app-view { display: block; width: 100%; height: 100%; padding-bottom: 60px; overflow-y: auto; }
        .header { background-color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 10; }
        .logo { font-weight: bold; font-size: 22px; color: #ff0000; display: flex; align-items: center; gap: 5px; }
        .search-bar { background: #f0f0f0; border-radius: 20px; padding: 8px 15px; width: 60%; display: flex; align-items: center; color: #606060; font-size: 14px; }
        .video-grid { display: grid; grid-template-columns: 1fr; gap: 15px; padding: 15px; }
        .video-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .thumbnail { width: 100%; height: 200px; background-color: #000; position: relative; }
        .thumbnail img { width: 100%; height: 100%; object-fit: cover; opacity: 0.8; }
        .play-icon { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-size: 40px; opacity: 0.8; }
        .info { padding: 10px; }
        .title { font-weight: bold; font-size: 14px; margin-bottom: 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .meta { font-size: 12px; color: #606060; }

        #settings-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 100; transform: translateY(100%); transition: transform 0.3s; display: flex; flex-direction: column; }
        #settings-modal.open { transform: translateY(0); }
        .settings-header { padding: 15px; border-bottom: 1px solid #eee; display: flex; align-items: center; gap: 15px; font-weight: bold; font-size: 18px; }
        .settings-content { padding: 20px; flex: 1; overflow-y: auto; }
        .setting-item { padding: 15px 0; border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center; }
        .copyright { margin-top: 50px; text-align: center; color: #ccc; font-size: 12px; padding: 20px; user-select: none; }

        #secret-chat { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #121212; z-index: 999; flex-direction: column; color: white; }
        .chat-header { padding: 15px; background: #1f1f1f; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; }
        .status-dot { width: 10px; height: 10px; background: #ff4444; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .status-dot.online { background: #00C851; }
        .chat-area { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .message { max-width: 80%; padding: 10px 15px; border-radius: 15px; font-size: 14px; word-wrap: break-word; position: relative; }
        .message.sent { align-self: flex-end; background: #007bff; border-bottom-right-radius: 2px; }
        .message.received { align-self: flex-start; background: #2a2a2a; border-bottom-left-radius: 2px; }
        .message img, .message video { max-width: 100%; border-radius: 10px; margin-top: 5px; }
        .input-area { padding: 10px; background: #1f1f1f; display: flex; align-items: center; gap: 10px; }
        .chat-input { flex: 1; background: #2a2a2a; border: none; padding: 12px; border-radius: 20px; color: white; outline: none; }
        .icon-btn { color: #007bff; font-size: 20px; background: none; border: none; cursor: pointer; padding: 5px; }
        .connect-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #121212; z-index: 10; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; }
        .id-display { font-size: 24px; font-weight: bold; margin: 20px 0; letter-spacing: 2px; color: #00C851; font-family: monospace; text-align: center; }
        .id-input { background: #2a2a2a; border: 1px solid #333; padding: 15px; border-radius: 10px; color: white; width: 100%; margin-bottom: 15px; text-align: center; font-size: 16px; }
        .btn { background: #007bff; color: white; border: none; padding: 12px 30px; border-radius: 25px; font-weight: bold; width: 100%; cursor: pointer; }
        .hidden-file { display: none; }
        
        .nudge-anim { animation: shake 0.5s; }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 20% { transform: translate(-3px, 0px) rotate(1deg); } 30% { transform: translate(3px, 2px) rotate(0deg); } 40% { transform: translate(1px, -1px) rotate(1deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 60% { transform: translate(-3px, 1px) rotate(0deg); } 70% { transform: translate(3px, 1px) rotate(-1deg); } 80% { transform: translate(-1px, -1px) rotate(1deg); } 90% { transform: translate(1px, 2px) rotate(0deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }
    </style>
</head>
<body>

    <div id="app-view">
        <div class="header">
            <div class="logo"><i class="fab fa-youtube"></i> VideoTube</div>
            <div class="search-bar"><i class="fas fa-search"></i> &nbsp; Pesquisar...</div>
            <i class="fas fa-cog" style="color: #606060; font-size: 20px;" onclick="openSettings()"></i>
        </div>
        <div class="video-grid" id="videoGrid"></div>
    </div>

    <div id="settings-modal">
        <div class="settings-header">
            <i class="fas fa-arrow-left" onclick="closeSettings()"></i> ConfiguraÃ§Ãµes
        </div>
        <div class="settings-content">
            <div class="setting-item"><span>ReproduÃ§Ã£o automÃ¡tica</span> <i class="fas fa-toggle-on" style="color: #007bff"></i></div>
            <div class="setting-item"><span>Economia de dados</span> <i class="fas fa-toggle-off" style="color: #ccc"></i></div>
            <div class="setting-item"><span>Controle dos pais</span> <span>Ativado</span></div>
            <div class="setting-item"><span>VersÃ£o do App</span> <span>2.4.0</span></div>
            <div class="copyright" id="copyrightTrigger">Â© 2026 VideoTube Inc. Todos os direitos reservados.</div>
        </div>
    </div>

    <div id="secret-chat">
        <div class="connect-screen" id="connectScreen">
            <h3>CHAT SEGREDO</h3>
            <p style="color: #888; font-size: 12px; margin-top: 5px;">Sistema criptografado P2P</p>
            
            <div style="margin-top: 30px;">SEU ID:</div>
            <div class="id-display" id="myId">GERANDO...</div>
            <button class="btn" onclick="copyId()" style="background: #333; margin-bottom: 30px; font-size: 12px; padding: 8px;">Copiar ID</button>

            <input type="text" id="friendId" class="id-input" placeholder="Cole o ID do amigo aqui">
            <button class="btn" onclick="connectToPeer()">CONECTAR</button>
            <p id="connStatus" style="margin-top: 15px; color: #ff4444; font-size: 12px;"></p>
        </div>

        <div class="chat-header">
            <div style="display: flex; align-items: center;">
                <div class="status-dot" id="statusDot"></div>
                <span id="chatTitle">Desconectado</span>
            </div>
            <div style="display: flex; gap: 15px;">
                <i class="fas fa-bell" onclick="sendNudge()"></i>
                <i class="fas fa-sign-out-alt" onclick="exitChat()"></i>
            </div>
        </div>

        <div class="chat-area" id="chatArea"></div>

        <div class="input-area">
            <input type="file" id="fileInput" class="hidden-file" onchange="handleFileSelect(this)">
            <button class="icon-btn" onclick="document.getElementById('fileInput').click()"><i class="fas fa-paperclip"></i></button>
            <input type="text" class="chat-input" id="msgInput" placeholder="Mensagem..." onkeypress="handleEnter(event)">
            <button class="icon-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <script>
        // --- 1. LÃ“GICA DO APP FALSO ---
        const videos = [
            { title: "Minecraft: SobrevivÃªncia #1", img: "https://i.ytimg.com/vi/MmB9b5njVbA/hqdefault.jpg" },
            { title: "Como fazer slime fÃ¡cil", img: "https://i.ytimg.com/vi/gW6226T9E9c/hqdefault.jpg" },
            { title: "Roblox: O novo update", img: "https://i.ytimg.com/vi/9unCj2k7yL8/hqdefault.jpg" },
            { title: "Jogando Free Fire ranqueada", img: "https://i.ytimg.com/vi/M2e9Vl4wLdY/hqdefault.jpg" }
        ];

        const grid = document.getElementById('videoGrid');
        videos.forEach(v => {
            const card = document.createElement('div');
            card.className = 'video-card';
            card.innerHTML = `<div class="thumbnail"><img src="${v.img}"><i class="fas fa-play-circle play-icon"></i></div><div class="info"><div class="title">${v.title}</div><div class="meta">1.2M visualizaÃ§Ãµes â€¢ hÃ¡ 2 horas</div></div>`;
            grid.appendChild(card);
        });

        function openSettings() { document.getElementById('settings-modal').classList.add('open'); }
        function closeSettings() { document.getElementById('settings-modal').classList.remove('open'); }

        // --- 2. LÃ“GICA DO GATILHO (TRIGGER) ---
        let copyrightClicks = 0;
        let secretUnlocked = false;
        
        document.getElementById('copyrightTrigger').addEventListener('click', () => {
            copyrightClicks++;
            if (copyrightClicks === 4) {
                history.pushState({page: 1}, "title 1", "?s=1");
                history.pushState({page: 2}, "title 2", "?s=2");
                
                window.onpopstate = function(event) {
                    if (copyrightClicks >= 4) {
                        launchSecretChat();
                    }
                };
            }
        });

        function launchSecretChat() {
            secretUnlocked = true;
            document.getElementById('settings-modal').classList.remove('open');
            document.getElementById('app-view').style.display = 'none';
            document.getElementById('secret-chat').style.display = 'flex';
            document.title = "ConfiguraÃ§Ã£o de Sistema"; 
            initPeer();
        }

        function exitChat() {
            location.reload();
        }

        // --- 3. LÃ“GICA DO CHAT (PEERJS) ---
        let peer = null;
        let conn = null;
        const myIdEl = document.getElementById('myId');
        const statusDot = document.getElementById('statusDot');
        const chatTitle = document.getElementById('chatTitle');
        const badWords = ["palavrao1", "feio", "bobo", "idiota"]; 

        function initPeer() {
            peer = new Peer(null, { debug: 2 });
            
            peer.on('open', (id) => {
                myIdEl.innerText = id;
            });

            peer.on('connection', (c) => {
                handleConnection(c);
            });
        }

        function connectToPeer() {
            const friendId = document.getElementById('friendId').value;
            if (!friendId) return;
            document.getElementById('connStatus').innerText = "Conectando...";
            const c = peer.connect(friendId);
            handleConnection(c);
        }

        function handleConnection(c) {
            conn = c;
            
            conn.on('open', () => {
                document.getElementById('connectScreen').style.display = 'none';
                chatTitle.innerText = "Conectado";
                statusDot.classList.add('online');
            });

            conn.on('data', (data) => {
                if (data.type === 'text') {
                    addMessage(data.content, 'received');
                } else if (data.type === 'file') {
                    addFile(data.content, data.fileType, 'received');
                } else if (data.type === 'nudge') {
                    triggerNudge();
                }
            });

            conn.on('close', () => {
                chatTitle.innerText = "Desconectado";
                statusDot.classList.remove('online');
                alert("ConexÃ£o perdida");
            });
        }

        // --- 4. ENVIO DE MENSAGENS E ARQUIVOS ---
        function filterText(text) {
            const regex = new RegExp(badWords.join('|'), 'gi');
            return text.replace(regex, match => '*'.repeat(match.length));
        }

        function sendMessage() {
            const input = document.getElementById('msgInput');
            const text = input.value;
            if (!text || !conn) return;

            const filtered = filterText(text);
            conn.send({ type: 'text', content: filtered });
            addMessage(filtered, 'sent');
            input.value = '';
        }

        function handleEnter(e) {
            if (e.key === 'Enter') sendMessage();
        }

        function addMessage(text, type) {
            const div = document.createElement('div');
            div.className = `message ${type}`;
            div.innerText = text;
            document.getElementById('chatArea').appendChild(div);
            div.scrollIntoView();
        }

        // --- 5. LÃ“GICA DE ARQUIVOS ---
        function handleFileSelect(input) {
            const file = input.files[0];
            if (!file || !conn) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const dataUrl = e.target.result;
                conn.send({ type: 'file', content: dataUrl, fileType: file.type });
                addFile(dataUrl, file.type, 'sent');
            };
            reader.readAsDataURL(file);
        }

        function addFile(url, type, msgType) {
            const div = document.createElement('div');
            div.className = `message ${msgType}`;
            
            if (type.startsWith('image/')) {
                div.innerHTML = `<img src="${url}">`;
            } else if (type.startsWith('video/')) {
                div.innerHTML = `<video src="${url}" controls></video>`;
            } else {
                div.innerHTML = `<a href="${url}" download="arquivo" style="color:white">ðŸ“„ Baixar Arquivo</a>`;
            }
            
            document.getElementById('chatArea').appendChild(div);
            div.scrollIntoView();
        }

        // --- 6. FUNÃ‡ÃƒO TOQUE (NUDGE) ---
        function sendNudge() {
            if (conn) {
                conn.send({ type: 'nudge' });
                addMessage("ðŸ”” VocÃª enviou um toque!", "sent");
            }
        }

        function triggerNudge() {
            // VibraÃ§Ã£o
            if (navigator.vibrate) navigator.vibrate([200, 100, 200]);
            
            // Som (Beep gerado via AudioContext para nÃ£o precisar de arquivo externo)
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            osc.frequency.value = 440; 
            osc.type = 'sine';
            osc.start();
            gain.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + 0.5);
            
            // AnimaÃ§Ã£o visual
            document.body.classList.add('nudge-anim');
            setTimeout(() => { 
                document.body.classList.remove('nudge-anim'); 
                osc.stop();
            }, 500);

            addMessage("ðŸ”” ATENÃ‡ÃƒO! ALGUÃ‰M TE CHAMOU!", "received");
        }
    </script>
</body>
</html>
